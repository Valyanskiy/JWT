<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="./css/style.css" rel="stylesheet" type="text/css">
</head>
<body>
<header class="w-full flex justify-between flex-row">
    <h1 class="text-3xl m-3">–°–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h1>
    <button id="auth" class="w-fit h-fit bg-blue-600 rounded-2xl self-center m-3">
        <p class="m-2">–í–æ–π—Ç–∏</p>
    </button>
</header>
<main class="w-full flex justify-center">
<!--    <div class="flex flex-col justify-center">-->
        <p id="secretData">–¢—É—Ç–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç üòó</p>
<!--    </div>-->
</main>
<script>
    document.getElementById('auth').addEventListener('click', () => {
        window.location.href = '/auth.html';
    });

    const secretData = document.getElementById('secretData');

    // –û–±–µ—Ä–Ω—É—Ç—å –ª–æ–≥–∏–∫—É –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
    const loadProtectedData = async () => {
        try {
            const response = await fetch('http://localhost:3000/protected', {
                method: 'GET',
                headers: {
                    authorization: `Bearer ${localStorage.getItem('jwt')}`
                }
            });

            const data = await response.json();
            console.log('–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', data);

            if(response.ok) {
                secretData.textContent = data.message; // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç secretContent
            } else {
                alert(data.message || '–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞');
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞:', error);
            // alert('–°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ');
        }
    }

    loadProtectedData();
</script>
</body>
</html>